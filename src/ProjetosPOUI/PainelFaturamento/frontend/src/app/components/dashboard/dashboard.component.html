<!-- Template do Dashboard com PO-UI -->
<div class="dashboard-container">
  <!-- Cabeçalho -->
  <div class="dashboard-header">
    <po-page-header 
      p-title="Dashboard de Faturamento"
      p-subtitle="Visão geral dos indicadores de negócio">
      
      <po-button 
        p-label="Atualizar" 
        p-icon="ph ph-arrow-clockwise"
        (p-click)="atualizarDados()"
        [p-loading]="isLoading">
      </po-button>
    </po-page-header>
  </div>

  <!-- Loading -->
  <po-loading-overlay 
    *ngIf="isLoading" 
    p-text="Carregando dashboard...">
  </po-loading-overlay>

  <!-- Conteúdo principal -->
  <div class="dashboard-content" *ngIf="!isLoading">
    
    <!-- Cards de KPI -->
    <div class="kpi-section">
      <po-row>
        <po-col [p-sm]="12" [p-md]="6" [p-lg]="3" *ngFor="let card of cards">
          <po-widget class="kpi-card" [ngClass]="card.color">
            <div class="kpi-content">
              <div class="kpi-icon">
                <po-icon [p-icon]="card.icon" p-size="large"></po-icon>
              </div>
              <div class="kpi-info">
                <h3 class="kpi-title">{{ card.title }}</h3>
                <div class="kpi-value" *ngIf="card.title.includes('Faturamento') || card.title.includes('Meta')">
                  {{ formatarMoeda(card.value) }}
                </div>
                <div class="kpi-value" *ngIf="!card.title.includes('Faturamento') && !card.title.includes('Meta')">
                  {{ formatarNumero(card.value) }}
                </div>
                <div class="kpi-variation" [ngClass]="getVariationClass(card.variation)" *ngIf="card.variation !== 0">
                  <po-icon [p-icon]="card.variation > 0 ? 'ph ph-trend-up' : 'ph ph-trend-down'"></po-icon>
                  {{ Math.abs(card.variation) }}%
                </div>
              </div>
            </div>
          </po-widget>
        </po-col>
      </po-row>
    </div>

    <!-- Seção de Gráficos -->
    <div class="charts-section">
      <po-row>
        <!-- Gráfico de Faturamento Diário -->
        <po-col [p-sm]="12" [p-md]="8">
          <po-widget>
            <po-chart 
              [p-type]="chartFaturamento.type"
              [p-title]="chartFaturamento.title"
              [p-series]="chartFaturamento.series"
              [p-options]="chartFaturamento.options"
              p-height="300">
            </po-chart>
          </po-widget>
        </po-col>

        <!-- Gráfico de Vendedores -->
        <po-col [p-sm]="12" [p-md]="4">
          <po-widget>
            <po-chart 
              [p-type]="chartVendedores.type"
              [p-title]="chartVendedores.title"
              [p-series]="chartVendedores.series"
              [p-options]="chartVendedores.options"
              p-height="300">
            </po-chart>
          </po-widget>
        </po-col>
      </po-row>

      <po-row>
        <!-- Gráfico de Top Produtos -->
        <po-col [p-sm]="12">
          <po-widget>
            <po-chart 
              [p-type]="chartProdutos.type"
              [p-title]="chartProdutos.title"
              [p-series]="chartProdutos.series"
              [p-options]="chartProdutos.options"
              p-height="300">
            </po-chart>
          </po-widget>
        </po-col>
      </po-row>
    </div>

    <!-- Resumo Rápido -->
    <div class="summary-section">
      <po-row>
        <po-col [p-sm]="12" [p-md]="6">
          <po-widget>
            <po-widget-header p-title="Progresso da Meta">
              <po-button 
                p-kind="tertiary" 
                p-size="small" 
                p-icon="ph ph-info"
                p-label="Detalhes">
              </po-button>
            </po-widget-header>
            
            <div class="progress-container">
              <po-progress 
                [p-value]="calcularProgressoMeta()"
                p-text="Meta Mensal">
              </po-progress>
              <div class="progress-info">
                <span>Realizado: {{ formatarMoeda(dashboardData?.faturamentoMes || 0) }}</span>
                <span>Meta: {{ formatarMoeda(dashboardData?.metaMensal || 0) }}</span>
              </div>
            </div>
          </po-widget>
        </po-col>

        <po-col [p-sm]="12" [p-md]="6">
          <po-widget>
            <po-widget-header p-title="Ações Rápidas">
            </po-widget-header>
            
            <div class="quick-actions">
              <po-button 
                p-label="Ver Pedidos Pendentes" 
                p-icon="ph ph-list"
                routerLink="/pedidos-pendentes"
                class="action-button">
              </po-button>
              
              <po-button 
                p-label="Ranking de Clientes" 
                p-icon="ph ph-ranking"
                routerLink="/ranking-clientes"
                class="action-button">
              </po-button>
              
              <po-button 
                p-label="Relatórios" 
                p-icon="ph ph-file-text"
                routerLink="/relatorios"
                class="action-button">
              </po-button>
            </div>
          </po-widget>
        </po-col>
      </po-row>
    </div>

  </div>
</div>
